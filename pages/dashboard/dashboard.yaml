id: dashboard
type: PageHeaderMenu
properties:
  title: Dashboard

layout:
  contentGutter: 10

events:
  onMount:
    - id: init
      type: SetState
      params:
        # Set everything to loading
        revenue_cards_loading: true
        revenue_charts_loading: true
        user_cards_loading: true
        user_charts_loading: true
        default_start_date:
          _date: 2024-02-20 #TODO: Make week before current
        default_end_date:
          _date: now

  onMountAsync:
    _ref: pages/dashboard/components/actions/refresh_revenue_section.yaml
    
requests:
  - _ref: pages/dashboard/components/cards/requests/fetch_orders_cancelled.yaml
  - _ref: pages/dashboard/components/cards/requests/fetch_services_cancelled.yaml
  - _ref: pages/dashboard/components/cards/requests/fetch_orders_completed.yaml
  - _ref: pages/dashboard/components/cards/requests/fetch_services_completed.yaml
  - _ref: pages/dashboard/components/charts/requests/fetch_revenue.yaml

areas:
  content:
    justify: center
    blocks:
      - id: section_income
        type: Title 
        properties:
          content: Revenue Data
          level: 3
      
      - _ref: pages/dashboard/components/revenue_range_selector.yaml
      
      - id: revenue_data_container
        type: Box
        layout:
          span: 24
          contentGutter: 16
        blocks:
          - _ref: pages/dashboard/components/charts/revenue_chart.yaml
          - _ref: pages/dashboard/components/charts/revenue_pie.yaml
          
          - _ref: pages/dashboard/components/cards/orders_completed.yaml
          - _ref: pages/dashboard/components/cards/services_completed.yaml
          - _ref: pages/dashboard/components/cards/orders_cancelled.yaml
          - _ref: pages/dashboard/components/cards/services_cancelled.yaml

      - id: section_divider
        type: Divider

      - id: test_title
        type: Title
        visible: 
          _state: title_visible
        properties:
          content: 
            _state: 
              key: saved_title
              default: 
                _date: 2024-02-27
          level: 3

      # - id: section_users
      #   type: Title
      #   properties:
      #     content: User Data
      #     level: 3

      # - id: date_range_container
      #   type: Box
      #   layout:
      #     span: 12
      #     align: center
      #     offset: 6
      #   blocks:
      #     - id: users_date_range
      #       type: DateRangeSelector
      #       properties:
      #         placeholder:
      #           - Start Date
      #           - End Date
      #         title: "User Activity Date Range"
      #         # title:
      #         disabledDates:
      #           max: 
      #             _state: 
      #               key: start_date_revenue
      #               default: 
      #                 _date: now
      #       # events:
      #       #   properties:
      #       #     onChange:
      #       #       - id: set_user_dates
      #       #         type: SetState
      #       #         params:
      #       #           start_date_users: #TODO use input date
      #       #           end_date_users: #TODO use input date
        
      # - _ref: pages/dashboard/components/charts/active_user_chart.yaml

      # - id: user_activity_data
      #   type: Box
      #   layout: 
      #     span: 8
      #     contentGutter: 10
      #   blocks:
      #     - _ref: pages/dashboard/components/cards/account_creations.yaml